function buildScroller(){imgWrap=document.createElement("div"),imgWrap.setAttribute("class","img-wrap"),scroller.appendChild(imgWrap),scrollerRight=document.createElement("div"),scrollerRight.setAttribute("class","slide-show-right"),scroller.appendChild(scrollerRight),scrollerLeft=document.createElement("div"),scrollerLeft.setAttribute("class","slide-show-left"),scroller.appendChild(scrollerLeft),scrollerTitle=document.createElement("p"),scrollerLink=document.createElement("a"),timelineWrap=document.createElement("div"),timelineWrap.setAttribute("class","timeline-wrap"),scroller.appendChild(timelineWrap),bigDot=document.createElement("div"),bigDot.setAttribute("class","dot-big"),smallDot=document.createElement("div"),smallDot.setAttribute("class","dot-small")}function updateScroller(e){"new"==e?buildTimeline():"timeline"==e?updateTimeline(curImgNum):"right"==e?(curImgNum==imgList.length-1?curImgNum=0:curImgNum++,updateTimeline(curImgNum)):"left"==e?(0==curImgNum?curImgNum=imgList.length-1:curImgNum--,updateTimeline(curImgNum)):console.log("what direction is the scroller going?!!");var i;null!=imgList[curImgNum].dataset.slideShowLink?(i=scrollerLink.cloneNode(!0),i.href=imgList[curImgNum].dataset.slideShowLink):i=scrollerTitle.cloneNode(!0),i.textContent=imgList[curImgNum].title,imgWrap.appendChild(i);var t=imgList[curImgNum].cloneNode(!0);setImgDimensions(t),imgWrap.appendChild(t),imgWrap.setAttribute("class","img-wrap img-wrap-show"),updateTimeline(curImgNum)}function clearScroller(){imgWrap.setAttribute("class","img-wrap img-wrap-hide");var e=imgWrap.querySelector("p")||imgWrap.querySelector("a"),i=imgWrap.querySelector("img");i&&e&&setTimeout(function(){imgWrap.removeChild(e),imgWrap.removeChild(i)},500)}function setImgDimensions(e){if(e){var i=e.width/e.height,t=minHeight,l=i*t;"fill"==scroller.dataset.slideShowFill&&l<scroller.offsetWidth&&(l=scroller.offsetWidth,t=scroller.offsetWidth*(1/i)),e.style.height=t+"px",e.style.width=l+"px",imgWrap.style.height=minHeight+"px"}else console.log("error no image!")}function buildTimeline(){tlLength=imgList.length;for(var e=0;e<tlLength;e++){var i=bigDot.cloneNode(!0);if(timelineMarkers.push(i),timelineWrap.appendChild(i),e!=tlLength-1){var t=smallDot.cloneNode(!0),l=smallDot.cloneNode(!0);timelineWrap.appendChild(t),timelineWrap.appendChild(l)}}var r=20*tlLength+20*(tlLength-1)*2;timelineWrap.style.width=r+"px",timelineMarkers[curImgNum].id="highlight";for(var o=0;o<timelineMarkers.length;o++)timelineMarkers[o].addEventListener("click",function(){var e=(new Date).getTime();if(e-curTime>800){curTime=(new Date).getTime();var i=timelineMarkers.indexOf(this);curImgNum!=i&&(timelineMarkers[curImgNum].id="",curImgNum=i,clearScroller(),setTimeout(function(){updateScroller("timeline")},500),updateTimeline(curImgNum))}else console.log("clicking too quickly!")})}function updateTimeline(e){for(var i=0;i<timelineMarkers.length;i++)timelineMarkers[i].id="";timelineMarkers[e].id="highlight"}function clearTimeline(){for(;timelineWrap.firstChild;)timelineWrap.removeChild(timelineWrap.firstChild);timelineMarkers=[]}function checkTime(){var e=(new Date).getTime();e-curTime>=delayTime&&(curTime=e,clearScroller(),setTimeout(function(){updateScroller(scrollerDirection)},500))}var scroller=document.querySelector(".slide-show"),imgList=scroller.querySelectorAll("img"),imgWrap,scrollerRight,scrollerLeft,scrollerTitle,scrollerLink,timelineWrap,bigDot,smallDot,curImgNum=0,curTime=(new Date).getTime(),delayTime=scroller.dataset.slideShowDelay||5e3,scrollerDirection=scroller.dataset.slideShowDirection||"right",timelineMarkers=[],minHeight;buildScroller(),imgList[0].onload=function(){for(var e=1e5,i=0;i<imgList.length;i++)imgList[i].height<e&&(e=imgList[i].height),scroller.removeChild(imgList[i]);0!=scroller.clientHeight?(console.log(scroller.clientHeight),minHeight=scroller.clientHeight):(console.log("no scroll dimensions set!"),minHeight=e),clearScroller(),setTimeout(function(){updateScroller("new")},500),setInterval(function(){checkTime()},delayTime)},window.onresize=function(){setImgDimensions(imgWrap.querySelector("img"))},scrollerRight.onclick=function(){var e=(new Date).getTime();e-curTime>800?(curTime=(new Date).getTime(),clearScroller(),setTimeout(function(){updateScroller("right")},500)):console.log("clicking too quickly!")},scrollerLeft.onclick=function(){var e=(new Date).getTime();e-curTime>800?(curTime=(new Date).getTime(),clearScroller(),setTimeout(function(){updateScroller("left")},500)):console.log("clicking too quickly!")};